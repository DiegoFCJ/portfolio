<footer class="site-footer" aria-label="Piè di pagina">
  <ng-container *ngIf="content$ | async as content">
    <div class="footer-shell">
      <div class="footer-top">
        <section class="footer-card footer-brand" aria-labelledby="footer-brand-title">
          <div class="footer-brand-header">
            <span class="footer-logo" aria-hidden="true">{{ getInitials(content.brandName) }}</span>

            <div class="footer-brand-copy">
              <p class="footer-brand-title" id="footer-brand-title">{{ content.brandName }}</p>
              <p class="footer-brand-subtitle">{{ content.brandSubtitle }}</p>
            </div>
          </div>

          <ul class="footer-highlights" aria-label="Focus principali">
            <li class="footer-highlight" *ngFor="let badge of content.highlightChips; trackBy: trackByValue">
              {{ badge }}
            </li>
          </ul>

          <div class="footer-social" *ngIf="socials$ | async as socials" aria-label="Social media">
            <a
              *ngFor="let social of socials; trackBy: trackBySocial"
              class="footer-social-link"
              [href]="social.link"
              target="_blank"
              rel="noopener noreferrer"
              [attr.aria-label]="social.label"
              [title]="social.label"
            >
              <img [src]="social.icon" [alt]="social.label" loading="lazy" />
            </a>
          </div>
        </section>

        <section
          class="footer-card footer-column"
          *ngFor="let group of content.navigationGroups; trackBy: trackByGroupTitle"
        >
          <p class="footer-column-title">{{ group.title }}</p>
          <nav class="footer-links" [attr.aria-label]="group.title">
            <ng-container *ngFor="let link of group.links; trackBy: trackByLink">
              <ng-container
                *ngTemplateOutlet="link.external ? externalLink : internalLink; context: { $implicit: link }"
              ></ng-container>
            </ng-container>
          </nav>
        </section>

        <section class="footer-card footer-contact">
          <p class="footer-column-title">{{ content.contact.title }}</p>
          <p class="footer-contact-text">{{ content.contact.availability }}</p>
          <p class="footer-contact-text footer-contact-callout">
            {{ content.contact.invitation }}
          </p>
          <a class="footer-email" [href]="content.contact.email.link">
            {{ content.contact.email.label }}
          </a>
          <p class="footer-contact-text footer-contact-muted">{{ content.contact.location }}</p>
        </section>
      </div>

      <div class="footer-bottom">
        <p class="footer-copy">
          &copy; {{ currentYear }} {{ content.brandName }}. {{ content.bottomNote }}
        </p>

        <div class="footer-bottom-links">
          <ng-container *ngFor="let link of content.bottomLinks; trackBy: trackByLink; let last = last">
            <ng-container
              *ngTemplateOutlet="link.external ? externalLink : internalLink; context: { $implicit: link }"
            ></ng-container>
            <span *ngIf="!last" class="footer-divider" aria-hidden="true">•</span>
          </ng-container>
        </div>
      </div>
    </div>
  </ng-container>

  <ng-template #internalLink let-link>
    <a class="footer-link" [routerLink]="link.link" [fragment]="link.fragment">
      {{ link.label }}
    </a>
  </ng-template>

  <ng-template #externalLink let-link>
    <a class="footer-link" [href]="link.link" target="_blank" rel="noopener noreferrer">
      {{ link.label }}
    </a>
  </ng-template>
</footer>
