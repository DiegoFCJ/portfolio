<div
  class="navigator-wrapper"
  [class.navigator-wrapper--collapsed]="!isOpen"
  [class.navigator-wrapper--with-assistant]="showEmbeddedAssistant"
  [class.navigator-wrapper--assistant-active]="assistantIsActive"
>
  <!-- Modern, animated, circular floating navbar -->
  <div class="modern-navigator" [class.modern-navigator--collapsed]="!isOpen">
    <ng-container *ngIf="isOpen">
      <div class="arrow-container" *ngIf="showSectionNavigation">
        <!-- Previous button -->
        <button class="arrow-button navigator-circle-button" *ngIf="currentSectionIndex > 0" (click)="onPrevious()" [attr.aria-label]="getTooltip('prev')"
          [matTooltip]="getTooltip('prev')" matTooltipPosition="left">
          <mat-icon aria-hidden="true">arrow_upward</mat-icon>
        </button>

        <!-- Next button -->
        <button class="arrow-button navigator-circle-button" *ngIf="currentSectionIndex < totalSections - 1" (click)="onNext()" [attr.aria-label]="getTooltip('next')"
          [matTooltip]="getTooltip('next')" matTooltipPosition="left">
          <mat-icon aria-hidden="true">arrow_downward</mat-icon>
        </button>
      </div>

      <div class="nav-groups">
        <div class="nav-group" *ngIf="pageNavigationItems.length > 0">
          <button
            class="nav-button"
            (click)="togglePageOptions()"
            [attr.aria-label]="getTooltip('pages')"
            [matTooltip]="getTooltip('pages')"
            matTooltipPosition="left"
            [attr.aria-expanded]="showPageOptions"
            aria-haspopup="true"
          >
            <mat-icon aria-hidden="true">menu</mat-icon>
          </button>

          <div class="page-menu" *ngIf="showPageOptions" role="menu">
            <button
              type="button"
              class="page-menu__item"
              *ngFor="let item of pageNavigationItems; trackBy: trackPageByRoute"
              (click)="navigateToPage(item)"
              role="menuitem"
            >
              {{ item.label | uppercase }}
            </button>
          </div>
        </div>

        <div class="nav-group">
          <button class="nav-button" (click)="toggleThemeOptions()" [attr.aria-label]="getTooltip('theme')"
            [matTooltip]="getTooltip('theme')" matTooltipPosition="left">
            <mat-icon aria-hidden="true">{{ getThemeIcon(currentTheme) }}</mat-icon>
          </button>
          <div class="option-container" *ngIf="showThemeOptions">
            <div class="option-item" *ngFor="let theme of availableThemes">
              <span class="option-hint" [id]="'theme-option-hint-' + theme">{{ getThemeName(theme) }}</span>
              <button class="option-button" (click)="changeTheme(theme)" [attr.aria-label]="getThemeName(theme)"
                [class.selected]="currentTheme === theme"
                [attr.aria-describedby]="'theme-option-hint-' + theme">
                <mat-icon aria-hidden="true">{{ getThemeIcon(theme) }}</mat-icon>
              </button>
            </div>
          </div>
        </div>

        <div class="nav-group">
          <button class="nav-button" (click)="toggleLanguageOptions()" [attr.aria-label]="getTooltip('language')"
            [matTooltip]="getTooltip('language')" matTooltipPosition="left">
            <span class="lang-label">{{ currentLang | slice:0:3 | uppercase }}</span>
          </button>
          <div class="option-container" *ngIf="showLanguageOptions">
            <div class="option-item" *ngFor="let language of availableLanguages">
              <span class="option-hint" [id]="'language-option-hint-' + language">{{ getLanguageName(language) }}</span>
              <button class="option-button" (click)="changeLanguage(language)"
                [attr.aria-label]="getLanguageName(language)"
                [attr.aria-describedby]="'language-option-hint-' + language">
                <img class="lang-flag" [src]="getLanguageFlag(language)" [alt]="getLanguageName(language)" />
              </button>
            </div>
          </div>
        </div>
      </div>
    </ng-container>

    <button class="nav-button close-button nav-toggle-button" (click)="toggleNavigator()"
      [attr.aria-label]="getToggleButtonLabel()"
      [matTooltip]="getToggleButtonLabel()" matTooltipPosition="left"
      [attr.aria-expanded]="isOpen">
      <mat-icon aria-hidden="true">expand_more</mat-icon>
    </button>
  </div>

  <div class="home__floating home__floating--stack" *ngIf="showStackControls">
    <div class="home__stack-controls">
      <button
        type="button"
        class="home__stack-button navigator-circle-button"
        (click)="onStackPreviousClick()"
        [attr.aria-label]="computedStackPreviousLabel"
      >
        <mat-icon aria-hidden="true">arrow_back</mat-icon>
      </button>

      <button
        type="button"
        class="home__stack-button navigator-circle-button"
        (click)="onStackNextClick()"
        [attr.aria-label]="computedStackNextLabel"
      >
        <mat-icon aria-hidden="true">arrow_forward</mat-icon>
      </button>
    </div>
  </div>

  <div class="navigator-wrapper__assistant" *ngIf="showEmbeddedAssistant">
    <app-assistant
      (opened)="onAssistantOpened()"
      (closed)="onAssistantClosed()"
    ></app-assistant>
  </div>
</div>
